<!--pages/search/search.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-container">
      <input 
        class="search-input" 
        placeholder="æœç´¢é¢˜ç›®" 
        value="{{searchValue}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearchTap"
      />
      <view class="search-clear" wx:if="{{searchValue.length > 0}}" bindtap="onClearInput">
        <text class="clear-icon">Ã—</text>
      </view>
    </view>
    <button class="search-btn" bindtap="onSearchTap">æœç´¢</button>
  </view>

  <!-- æœç´¢å†å² -->
  <view class="search-history" wx:if="{{showHistory && searchHistory.length > 0}}">
    <view class="section-header">
      <text class="section-title">æœç´¢å†å²</text>
      <text class="clear-history" bindtap="onClearHistory">æ¸…ç©º</text>
    </view>
    <view class="history-list">
      <view 
        class="history-item" 
        wx:for="{{searchHistory}}" 
        wx:key="*this"
        bindtap="onHistoryTap"
        data-keyword="{{item}}">
        <text class="history-text">{{item}}</text>
        <view class="delete-history" bindtap="onDeleteHistory" data-keyword="{{item}}" catchtap="true">
          <text class="delete-icon">Ã—</text>
        </view>
      </view>
    </view>
  </view>

  <!-- çƒ­é—¨æœç´¢ -->
  <view class="hot-search" wx:if="{{showHistory}}">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨æœç´¢</text>
    </view>
    <view class="hot-list">
      <view 
        class="hot-item" 
        wx:for="{{hotSearches}}" 
        wx:key="*this"
        bindtap="onHotSearchTap"
        data-keyword="{{item}}">
        <text class="hot-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢ä¸­çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{isSearching}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">æœç´¢ä¸­...</text>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view class="search-results" wx:if="{{hasSearched && !isSearching}}">
    <view class="results-header">
      <text class="results-count">æ‰¾åˆ° {{searchResults.length}} é“ç›¸å…³é¢˜ç›®</text>
      <view class="results-stats" wx:if="{{searchResults.length > 0}}">
        <text class="stats-item">é€‰æ‹©é¢˜ {{searchStats.byType['é€‰æ‹©é¢˜'] || 0}}</text>
        <text class="stats-item">åˆ¤æ–­é¢˜ {{searchStats.byType['åˆ¤æ–­é¢˜'] || 0}}</text>
      </view>
    </view>
    
    <!-- æ— ç»“æœ -->
    <view class="no-results" wx:if="{{searchResults.length === 0}}">
      <view class="no-results-icon">ğŸ”</view>
      <text class="no-results-title">æœªæ‰¾åˆ°ç›¸å…³é¢˜ç›®</text>
      <text class="no-results-desc">è¯•è¯•å…¶ä»–å…³é”®è¯å§</text>
    </view>

    <!-- ç»“æœåˆ—è¡¨ -->
    <view class="results-list" wx:if="{{searchResults.length > 0}}">
      <view 
        class="result-item" 
        wx:for="{{searchResults}}" 
        wx:key="id"
        bindtap="onQuestionTap"
        data-id="{{item.id}}">
        
        <view class="question-header">
          <view class="question-meta">
            <text class="question-type">{{item.type === 'choice' ? 'é€‰æ‹©é¢˜' : 'åˆ¤æ–­é¢˜'}}</text>
            <text class="question-level">Level {{item.level}}</text>
            <text class="question-difficulty">{{item.difficulty === 1 ? 'â˜…â˜†â˜†â˜†â˜†' : item.difficulty === 2 ? 'â˜…â˜…â˜†â˜†â˜†' : item.difficulty === 3 ? 'â˜…â˜…â˜…â˜†â˜†' : item.difficulty === 4 ? 'â˜…â˜…â˜…â˜…â˜†' : 'â˜…â˜…â˜…â˜…â˜…'}}</text>
          </view>
        </view>
        
        <view class="question-content">
          <text class="question-text">{{item.question}}</text>
          <view class="question-code" wx:if="{{item.code}}">
            <text class="code-text">{{item.code}}</text>
          </view>
        </view>
        
        <view class="question-tags" wx:if="{{item.tags && item.tags.length > 0}}">
          <text class="tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
        </view>
      </view>
    </view>
  </view>
</view>