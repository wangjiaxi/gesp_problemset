# 代码回滚设计文档

## 概述

由于项目未使用 Git 版本控制，我们需要设计一个手动回滚方案，通过识别和删除今天创建的文件，以及恢复今天修改的文件到原始状态。

## 架构

### 回滚策略
1. **文件识别**: 识别今天新增和修改的文件
2. **备份创建**: 创建当前状态的备份
3. **文件回滚**: 删除新增文件，恢复修改文件
4. **验证测试**: 验证回滚后的系统状态

## 组件和接口

### 1. 文件分析组件
- **功能**: 分析文件的创建和修改时间
- **输入**: 项目目录路径
- **输出**: 需要回滚的文件列表

### 2. 备份组件
- **功能**: 创建当前状态的完整备份
- **输入**: 项目目录
- **输出**: 备份文件夹

### 3. 回滚执行组件
- **功能**: 执行实际的文件删除和恢复操作
- **输入**: 回滚文件列表
- **输出**: 回滚操作结果

## 数据模型

### 文件状态模型
```javascript
{
  path: string,           // 文件路径
  status: 'new' | 'modified' | 'unchanged',  // 文件状态
  createdTime: Date,      // 创建时间
  modifiedTime: Date,     // 修改时间
  action: 'delete' | 'restore' | 'none'  // 需要执行的操作
}
```

## 错误处理

1. **文件权限错误**: 提供权限修复建议
2. **备份失败**: 提供替代备份方案
3. **回滚失败**: 提供手动回滚步骤

## 测试策略

1. **备份验证**: 确保备份完整性
2. **回滚验证**: 验证文件正确删除/恢复
3. **功能测试**: 验证小程序基本功能